# Break ç³»ç»Ÿå®Œå–„ä¸Ž Bug ä¿®å¤è®¡åˆ’

## 1. æ ¸å¿ƒ Bug ä¿®å¤ï¼šçœ©æ™•çŠ¶æ€ä¸‹çš„å¿…å®šå‘½ä¸­
**é—®é¢˜æè¿°**: å½“å‰é€»è¾‘ä¸‹ï¼Œå³ä½¿æ•Œäººå¤„äºŽçœ©æ™•ï¼ˆStunnedï¼‰çŠ¶æ€ï¼Œå…¶èº«ä¸Šçš„é—ªé¿ï¼ˆDodgeï¼‰è¯ç¼€ä¾ç„¶ç”Ÿæ•ˆï¼Œå¯¼è‡´çŽ©å®¶æ”»å‡»å¯èƒ½è½ç©ºã€‚
**ä¿®å¤é€»è¾‘**: çœ©æ™•çŠ¶æ€ä»£è¡¨å®Œå…¨å¤±åŽ»è¡ŒåŠ¨èƒ½åŠ›ï¼Œç†åº”æ— æ³•è¿›è¡Œé—ªé¿ã€‚
**ä¿®æ”¹ä½ç½®**: `js/skillEffects.js` -> `executeDamageEffect`

```javascript
// ä¼ªä»£ç é€»è¾‘
const applyDamage = (t) => {
  // åªæœ‰åœ¨æœªçœ©æ™•æ—¶æ‰è¿›è¡Œé—ªé¿åˆ¤å®š
  const isStunned = t.stunDuration && t.stunDuration > 0;
  
  if (!isStunned) {
    // å¤„ç†é—ªé¿è¯ç¼€ï¼ˆæ•Œäººä¸“å±žï¼‰
    if (processAffixDodge(t, result)) return;
    // å¤„ç†çŽ©å®¶é—ªé¿
    if (isEnemy && !t.isEnemy && checkPlayerDodge(t, result)) return;
  } else {
    // å¯é€‰ï¼šæ·»åŠ å¿…ä¸­æç¤º
    // result.logs.push({ text: `  ðŸŽ¯ ${t.name} å¤„äºŽçœ©æ™•çŠ¶æ€ï¼Œæ— æ³•é—ªé¿ï¼`, type: 'system' });
  }
  
  // ... åŽç»­ä¼¤å®³è®¡ç®—
};
```

## 2. é€»è¾‘ç»Ÿä¸€ï¼šä½™éœ‡ä¸Žæº…å°„çš„æ ‡å‡†åŒ–
**é—®é¢˜æè¿°**: `executeAftershockEffect` (ä½™éœ‡) å’Œ `executeSplashDamage` (æº…å°„) ç›®å‰æ˜¯ç‹¬ç«‹å®žçŽ°çš„ä¼¤å®³é€»è¾‘ã€‚è™½ç„¶å·²æ‰‹åŠ¨æ·»åŠ äº† Break å’Œéœ¸ä½“é€»è¾‘ï¼Œä½†å®ƒä»¬**æ— æ³•è§¦å‘æ•Œäººçš„é—ªé¿è¯ç¼€**ï¼Œå¯¼è‡´è¿™ä¸¤ç§ä¼¤å®³å˜æˆäº†â€œå¿…ä¸­â€ä¼¤å®³ï¼Œè¿™ä¸ç¬¦åˆæ¸¸æˆè§„åˆ™ã€‚
**ä¿®å¤é€»è¾‘**: åºŸå¼ƒæ‰‹åŠ¨å®žçŽ°ï¼Œç»Ÿä¸€è°ƒç”¨æ ¸å¿ƒå‡½æ•° `executeDamageEffect`ã€‚
**ä¿®æ”¹ä½ç½®**: `js/skillEffects.js`

*   **ä½™éœ‡ (Aftershock)**:
    *   è°ƒç”¨ `executeDamageEffect`
    *   å‚æ•°: `sourceType: DMG_SOURCE.ENVIRONMENT`
    *   æ•ˆæžœ: è§¦å‘é—ªé¿åˆ¤å®š(æœªçœ©æ™•æ—¶)ã€è§¦å‘ Breakã€å—éœ¸ä½“å‡ä¼¤ã€**ä¸**è§¦å‘åä¼¤ã€‚

*   **æº…å°„ (Splash)**:
    *   è°ƒç”¨ `executeDamageEffect`
    *   å‚æ•°: `sourceType: DMG_SOURCE.ENVIRONMENT`
    *   æ•ˆæžœ: åŒä¸Šã€‚

## 3. éªŒè¯æ¸…å•
1.  **çœ©æ™•å¿…ä¸­**: è®©æ•Œäººæ‹¥æœ‰é«˜é—ªé¿ï¼ˆå¦‚ 100%ï¼‰ï¼Œå…ˆå°†å…¶çœ©æ™•ï¼Œå†æ”»å‡»ï¼Œç¡®è®¤æ˜¯å¦å¿…å®šå‘½ä¸­ã€‚
2.  **ä½™éœ‡/æº…å°„é—ªé¿**: è®©æ•Œäººæ‹¥æœ‰é«˜é—ªé¿ï¼Œä½¿ç”¨ä½™éœ‡/æº…å°„æ”»å‡»ï¼Œç¡®è®¤æ˜¯å¦ä¼šå‘ç”Ÿé—ªé¿ã€‚
3.  **Break æœºåˆ¶**: ç¡®è®¤åœ¨ä¸Šè¿°ä¿®æ”¹åŽï¼Œç ´ç›¾é€»è¾‘ä¾ç„¶æ­£å¸¸å·¥ä½œã€‚

## 4. æž¶æž„å›¾ (Mermaid)

```mermaid
graph TD
    A[å‘èµ·æ”»å‡»/æŠ€èƒ½] --> B{ä¼¤å®³ç±»åž‹?}
    B -- DIRECT --> C[executeDamageEffect]
    B -- ENVIRONMENT (ä½™éœ‡/æº…å°„) --> C
    
    C --> D{ç›®æ ‡æ˜¯å¦çœ©æ™•?}
    D -- æ˜¯ --> E[è·³è¿‡é—ªé¿åˆ¤å®š (å¿…å®šå‘½ä¸­)]
    D -- å¦ --> F{é—ªé¿åˆ¤å®š}
    
    F -- é—ªé¿æˆåŠŸ --> G[ä¼¤å®³æ— æ•ˆ]
    F -- æœªé—ªé¿ --> H[è®¡ç®—ä¼¤å®³]
    
    H --> I{æŠ¤ç›¾åˆ¤å®š}
    I -- æœ‰æŠ¤ç›¾ä¸”æœªç ´ --> J[éœ¸ä½“å‡ä¼¤ 50%]
    I -- æ— æŠ¤ç›¾æˆ–å·²ç ´ --> K[æ­£å¸¸ä¼¤å®³]
    
    J --> L[æ‰£é™¤HP]
    K --> L
    
    L --> M{ä¼¤å®³ç±»åž‹?}
    M -- DIRECT --> N[è§¦å‘åä¼¤åˆ¤å®š]
    M -- ENVIRONMENT --> O[ä¸è§¦å‘åä¼¤]
    
    N --> P[ç ´ç›¾åˆ¤å®š (Break Check)]
    O --> P